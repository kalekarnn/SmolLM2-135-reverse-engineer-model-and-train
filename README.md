# SmolLM2: A Small Language Model Implementation

## Overview
This project implements a small-scale language model based on the LLaMA architecture. It includes both training and inference capabilities, with a user-friendly Gradio interface for text generation.

## Project Structure
├── model.py # Core model implementation (LLaMA architecture)
├── train.py # Training script with configuration
├── app.py # Gradio web interface for text generation
├── requirements.txt # Project dependencies
├── config_smollm2_135M.yaml # Model configuration
└── input.txt # Training data


## Setup

1. Create a virtual environment and activate it:

```bash
python -m venv venv
source venv/bin/activate
```

2. Install dependencies:

```bash
pip install -r requirements.txt
```

3. Run the training script:

```bash
python train.py
```


The training script includes:
- Gradient accumulation for memory efficiency
- Checkpoint saving and loading
- Progress monitoring with loss tracking
- Sample text generation during training
- Device-agnostic execution (supports CUDA, MPS, CPU)

Training parameters:
- Batch size: 2 (with gradient accumulation steps of 4)
- Sequence length: 512 tokens
- Training steps: 5000
- Checkpoints saved every 500 steps

## Text Generation

To use the trained model for text generation:

```bash
python app.py
```


This launches a Gradio web interface where you can:
- Enter custom prompts
- Adjust the maximum length of generated text
- View the generated output

## Model Architecture

The model is based on the LLaMA architecture with:
- 135M parameters
- 30 layers
- 9 attention heads
- 3 key-value heads (Grouped-Query Attention)
- 576 hidden dimension
- RMSNorm for layer normalization
- Rotary positional embeddings

## Requirements

- Python 3.8+
- PyTorch 2.0+
- Transformers
- Gradio
- Additional dependencies in requirements.txt

## Checkpoints

Checkpoints are saved in the `checkpoints` directory with the format:

`checkpoint_<step>.pt`



## Configuration

Model and training parameters can be modified in:
- `config_smollm2_135M.yaml`: Model architecture and training configuration
- `ModelConfig` class in train.py: Core model parameters

## License

[Add your license information here]

## Acknowledgments

This implementation is inspired by the LLaMA architecture and various open-source language model implementations.

## Training Logs

```

(venv) narendra.kalekar@MAC-KJF4T0J3JR SmolLM2-135-reverse-engineer-model-and-train % python3 train.py
2025-01-25 10:55:28,911 - INFO - Using device: mps
2025-01-25 10:55:31,216 - INFO - 
Model Architecture:
2025-01-25 10:55:31,216 - INFO - ==================================================
2025-01-25 10:55:31,217 - INFO - LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(49152, 576)
    (layers): ModuleList(
      (0-29): 30 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=576, out_features=576, bias=False)
          (k_proj): Linear(in_features=576, out_features=192, bias=False)
          (v_proj): Linear(in_features=576, out_features=192, bias=False)
          (o_proj): Linear(in_features=576, out_features=576, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=576, out_features=1536, bias=False)
          (up_proj): Linear(in_features=576, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=576, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=576, out_features=49152, bias=False)
)
2025-01-25 10:55:31,217 - INFO - ==================================================
2025-01-25 10:55:31,218 - INFO - 
Total trainable parameters: 134,515,008 (134.52M)
2025-01-25 10:55:31,218 - INFO - ==================================================

2025-01-25 10:55:32,027 - INFO - Set pad_token to eos_token
2025-01-25 10:55:32,032 - INFO - Loaded 7222 text segments from input.txt
2025-01-25 10:55:32,032 - INFO - No checkpoint found at 5000 steps. Starting fresh training.
Training (loss: 11.0054):  10%|████████████▊                                                                                                                   | 500/5000 [19:23<2:55:10,  2.34s/it]2025-01-25 11:15:09,968 - INFO - 
Sample generation at step 500:
2025-01-25 11:15:09,969 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 11:15:09,969 - INFO - Generated: Once upon a time, in a distant galaxyell one one one one one one one one one one one one one one one one one one one one oneestestestestestestestestestestestestestestICHestestestestestestestestest it it it it it it it it it it it it it it it it it it itICK oneNENENENENENENENE one one oneNENEMIN III III III III one III III IIIsss IIINENENEICK<|endoftext|>

2025-01-25 11:15:12,070 - INFO - Checkpoint saved at step 500
Training (loss: 8.5504):  16%|████████████████████▉                                                                                                            | 812/5000 [3Training (loss: 8.5504):  16%|████████████████████▉                                                                                                            | 813/5000 [3Training (loss: 8.5504):  16%|█████████████████████                                                                                                            | 814/5000 [3Training (loss: 8.5504):  16%|█████████████████████                                                                                                            | 815/5000 [3Training (loss: 8.5504):  16%|█████████████████████                                                                                                            | 816/5000 [3Training (loss: 8.5504):  16%|█████████████████████                                                                                                            | 817/5000 [3Training (loss: 8.5504):  16%|█████████████████████                                                                                                            | 818/5000 [3Training (loss: 8.5504):  16%|█████████████████████▏                                                                                                           | 819/5000 [3Training (loss: 8.5504):  16%|█████████████████████▏                                                                                                           | 820/5000 [3Training (loss: 8.5504):  16%|█████████████████████▏                                                                                                           | 821/5000 [3Training (loss: 8.5504):  16%|█████████████████████▏                                                                                                           | 822/5000 [3Training (loss: 8.5504):  16%|█████████████████████▏                                                                                                           | 823/5000 [3Training (loss: 8.5504):  16%|█████████████████████▎                                                                                                           | 824/5000 [3Training (loss: 8.5504):  16%|█████████████████████▎                                                                                                           | 825/5000 [3Training (loss: 8.5504):  17%|█████████████████████▎                                                                                                           | 826/5000 [3Training (loss: 8.5504):  17%|█████████████████████▎                                                                                                           | 827/5000 [3Training (loss: 8.5504):  17%|█████████████████████▎                                                                                                           | 828/5000 [3Training (loss: 8.5504):  17%|█████████████████████▍                                                                                                           | 829/5000 [3Training (loss: 8.5504):  17%|█████████████████████▍                                                                                                           | 830/5000 [3Training (loss: 8.5504):  17%|█████████████████████▍                                                                                                           | 831/5000 [3Training (loss: 8.5504):  17%|█████████████████████▍                                                                                                           | 832/5000 [3Training (loss: 8.5504):  17%|█████████████████████▍                                                                                                           | 833/5000 [3Training (loss: 8.5504):  17%|█████████████████████▌                                                                                                           | 834/5000 [3Training (loss: 8.5504):  17%|█████████████████████▌                                                                                                           | 835/5000 [3Training (loss: 8.5504):  17%|█████████████████████▌                                                                                                           | 836/5000 [3Training (loss: 8.5504):  17%|█████████████████████▌                                                                                                           | 837/5000 [3Training (loss: 8.5504):  17%|█████████████████████▌                                                                                                           | 838/5000 [3Training (loss: 8.5504):  17%|█████████████████████▋                                                                                                           | 839/5000 [3Training (loss: 8.5504):  17%|█████████████████████▋                                                                                                           | 840/5000 [3Training (loss: 8.5504):  17%|█████████████████████▋                                                                                                           | 841/5000 [3Training (loss: 8.5504):  17%|█████████████████████▋                                                                                                           | 842/5000 [3Training (loss: 8.5504):  17%|█████████████████████▋                                                                                                           | 843/5000 [3Training (loss: 8.5504):  17%|█████████████████████▊                                                                                                           | 844/5000 [3Training (loss: 8.5504):  17%|█████████████████████▊                                                                                                           | 845/5000 [3Training (loss: 8.5504):  17%|█████████████████████▊                                                                                                           | 846/5000 [3Training (loss: 8.5504):  17%|█████████████████████▊                                                                                                           | 847/5000 [3Training (loss: 8.5504):  17%|█████████████████████▉                                                                                                           | 848/5000 [3Training (loss: 8.5504):  17%|█████████████████████▉                                                                                                           | 849/5000 [3Training (loss: 8.5504):  17%|█████████████████████▉                                                                                                           | 850/5000 [3Training (loss: 8.5504):  17%|█████████████████████▉                                                                                                           | 851/5000 [3Training (loss: 8.5504):  17%|█████████████████████▉                                                                                                           | 852/5000 [3Training (loss: 8.5504):  17%|██████████████████████                                                                                                           | 853/5000 [3Training (loss: 8.5504):  17%|██████████████████████                                                                                                           | 854/5000 [3Training (loss: 8.5504):  17%|██████████████████████                                                                                                           | 855/5000 [3Training (loss: 8.5504):  17%|██████████████████████                                                                                                           | 856/5000 [3Training (loss: 8.5504):  17%|██████████████████████                                                                                                           | 857/5000 [3Training (loss: 8.5504):  17%|██████████████████████▏                                                                                                          | 858/5000 [3Training (loss: 8.5504):  17%|██████████████████████▏                                                                                                          | 859/5000 [3Training (loss: 8.5504):  17%|██████████████████████▏                                                                                                          | 860/5000 [3Training (loss: 8.5504):  17%|██████████████████████▏                                                                                                          | 861/5000 [3Training (loss: 8.5504):  17%|██████████████████████▏                                                                                                          | 862/5000 [3Training (loss: 8.5504):  17%|██████████████████████▎                                                                                                          | 863/5000 [3Training (loss: 8.5504):  17%|██████████████████████▎                                                                                                          | 864/5000 [3Training (loss: 8.5504):  17%|██████████████████████▎                                                                                                          | 865/5000 [3Training (loss: 8.5504):  17%|██████████████████████▎                                                                                                          | 866/5000 [3Training (loss: 8.5504):  17%|██████████████████████▎                                                                                                          | 867/5000 [3Training (loss: 8.5504):  17%|██████████████████████▍                                                                                                          | 868/5000 [3Training (loss: 8.5504):  17%|██████████████████████▍                                                                                                          | 869/5000 [3Training (loss: 8.5504):  17%|██████████████████████▍                                                                                                          | 870/5000 [3Training (loss: 8.5504):  17%|██████████████████████▍                                                                                                          | 871/5000 [3Training (loss: 8.5504):  17%|██████████████████████▍                                                                                                          | 872/5000 [3Training (loss: 8.5504):  17%|██████████████████████▌                                                                                                          | 873/5000 [3Training (loss: 8.5504):  17%|██████████████████████▌                                                                                                          | 874/5000 [3Training (loss: 8.5504):  18%|██████████████████████▌                                                                                                          | 875/5000 [3Training (loss: 8.5504):  18%|██████████████████████▌                                                                                                          | 876/5000 [3Training (loss: 8.5504):  18%|██████████████████████▋                                                                                                          | 877/5000 [3Training (loss: 8.5504):  18%|██████████████████████▋                                                                                                          | 878/5000 [3Training (loss: 8.5504):  18%|██████████████████████▋                                                                                                          | 879/5000 [3Training (loss: 8.5504):  18%|██████████████████████▋                                                                                                          | 880/5000 [3Training (loss: 8.5504):  18%|██████████████████████▋                                                                                                          | 881/5000 [3Training (loss: 8.5504):  18%|██████████████████████▊                                                                                                          | 882/5000 [3Training (loss: 8.5504):  18%|██████████████████████▊                                                                                                          | 883/5000 [3Training (loss: 8.5504):  18%|██████████████████████▊                                                                                                          | 884/5000 [3Training (loss: 8.5504):  18%|██████████████████████▊                                                                                                          | 885/5000 [3Training (loss: 8.5504):  18%|██████████████████████▊                                                                                                          | 886/5000 [3Training (loss: 8.5504):  18%|██████████████████████▉                                                                                                          | 887/5000 [3Training (loss: 8.5504):  18%|██████████████████████▉                                                                                                          | 888/5000 [3Training (loss: 8.5504):  18%|██████████████████████▉                                                                                                          | 889/5000 [3Training (loss: 8.5504):  18%|██████████████████████▉                                                                                                          | 890/5000 [3Training (loss: 8.5504):  18%|██████████████████████▉                                                                                                          | 891/5000 [3Training (loss: 8.5504):  18%|███████████████████████                                                                                                          | 892/5000 [3Training (loss: 8.5504):  18%|███████████████████████                                                                                                          | 893/5000 [3Training (loss: 8.5504):  18%|███████████████████████                                                                                                          | 894/5000 [3Training (loss: 8.5504):  18%|███████████████████████                                                                                                          | 895/5000 [3Training (loss: 8.5504):  18%|███████████████████████                                                                                                          | 896/5000 [3Training (loss: 8.5504):  18%|███████████████████████▏                                                                                                         | 897/5000 [3Training (loss: 8.5504):  18%|███████████████████████▏                                                                                                         | 898/5000 [3Training (loss: 8.5504):  18%|███████████████████████▏                                                                                                         | 899/5000 [3Training (loss: 8.5504):  18%|███████████████████████▏                                                                                                         | 900/5000 [3Training (loss: 8.6658):  18%|███████████████████████▏                                                                                                         | 900/5000 [3Training (loss: 8.6658):  18%|███████████████████████▏                                                                                                         | 901/5000 [3Training (loss: 8.6658):  18%|███████████████████████▎                                                                                                         | 902/5000 [3Training (loss: 8.6658):  18%|███████████████████████▎                                                                                                         | 903/5000 [3Training (loss: 8.6658):  18%|███████████████████████▎                                                                                                         | 904/5000 [3Training (loss: 8.6658):  18%|███████████████████████▎                                                                                                         | 905/5000 [3Training (loss: 8.6658):  18%|███████████████████████▎                                                                                                         | 906/5000 [3Training (loss: 8.6658):  18%|███████████████████████▍                                                                                                         | 907/5000 [3Training (loss: 8.6658):  18%|███████████████████████▍                                                                                                         | 908/5000 [3Training (loss: 8.6658):  18%|███████████████████████▍                                                                                                         | 909/5000 [3Training (loss: 8.6658):  18%|███████████████████████▍                                                                                                         | 910/5000 [3Training (loss: 8.6658):  18%|███████████████████████▌                                                                                                         | 911/5000 [3Training (loss: 8.6658):  18%|███████████████████████▌                                                                                                         | 912/5000 [3Training (loss: 8.6658):  18%|███████████████████████▌                                                                                                         | 913/5000 [3Training (loss: 8.6658):  18%|███████████████████████▌                                                                                                         | 914/5000 [3Training (loss: 8.6658):  18%|███████████████████████▌                                                                                                         | 915/5000 [3Training (loss: 8.6658):  18%|███████████████████████▋                                                                                                         | 916/5000 [3Training (loss: 8.6658):  18%|███████████████████████▋                                                                                                         | 917/5000 [3Training (loss: 8.6658):  18%|███████████████████████▋                                                                                                         | 918/5000 [3Training (loss: 8.6658):  18%|███████████████████████▋                                                                                                         | 919/5000 [3Training (loss: 8.6658):  18%|███████████████████████▋                                                                                                         | 920/5000 [3Training (loss: 8.6658):  18%|███████████████████████▊                                                                                                         | 921/5000 [3Training (loss: 8.6658):  18%|███████████████████████▊                                                                                                         | 922/5000 [3Training (loss: 8.6658):  18%|███████████████████████▊                                                                                                         | 923/5000 [3Training (loss: 8.6658):  18%|███████████████████████▊                                                                                                         | 924/5000 [3Training (loss: 8.6658):  18%|███████████████████████▊                                                                                                         | 925/5000 [3Training (loss: 8.6658):  19%|███████████████████████▉                                                                                                         | 926/5000 [3Training (loss: 8.6658):  19%|███████████████████████▉                                                                                                         | 927/5000 [3Training (loss: 8.6658):  19%|███████████████████████▉                                                                                                         | 928/5000 [3Training (loss: 8.6658):  19%|███████████████████████▉                                                                                                         | 929/5000 [3Training (loss: 8.6658):  19%|███████████████████████▉                                                                                                         | 930/5000 [3Training (loss: 8.6658):  19%|████████████████████████                                                                                                         | 931/5000 [3Training (loss: 8.6658):  19%|████████████████████████                                                                                                         | 932/5000 [3Training (loss: 8.6658):  19%|████████████████████████                                                                                                         | 933/5000 [3Training (loss: 8.6658):  19%|████████████████████████                                                                                                         | 934/5000 [3Training (loss: 8.6658):  19%|████████████████████████                                                                                                         | 935/5000 [3Training (loss: 8.6658):  19%|████████████████████████▏                                                                                                        | 936/5000 [3Training (loss: 8.6658):  19%|████████████████████████▏                                                                                                        | 937/5000 [3Training (loss: 8.6658):  19%|████████████████████████▏                                                                                                        | 938/5000 [3Training (loss: 8.6658):  19%|████████████████████████▏                                                                                                        | 939/5000 [3Training (loss: 8.6658):  19%|████████████████████████▎                                                                                                        | 940/5000 [3Training (loss: 8.6658):  19%|████████████████████████▎                                                                                                        | 941/5000 [3Training (loss: 8.6658):  19%|████████████████████████▎                                                                                                        | 942/5000 [3Training (loss: 8.6658):  19%|████████████████████████▎                                                                                                        | 943/5000 [3Training (loss: 8.6658):  19%|████████████████████████▎                                                                                                        | 944/5000 [3Training (loss: 8.6658):  19%|████████████████████████▍                                                                                                        | 945/5000 [3Training (loss: 8.6658):  19%|████████████████████████▍                                                                                                        | 946/5000 [3Training (loss: 8.6658):  19%|████████████████████████▍                                                                                                        | 947/5000 [3Training (loss: 8.6658):  19%|████████████████████████▍                                                                                                        | 948/5000 [3Training (loss: 8.6658):  19%|████████████████████████▍                                                                                                        | 949/5000 [3Training (loss: 8.6658):  19%|████████████████████████▌                                                                                                        | 950/5000 [3Training (loss: 8.6658):  19%|████████████████████████▌                                                                                                        | 951/5000 [3Training (loss: 8.6658):  19%|████████████████████████▌                                                                                                        | 952/5000 [3Training (loss: 8.6658):  19%|████████████████████████▌                                                                                                        | 953/5000 [3Training (loss: 8.6658):  19%|████████████████████████▌                                                                                                        | 954/5000 [3Training (loss: 8.6658):  19%|████████████████████████▋                                                                                                        | 955/5000 [3Training (loss: 8.6658):  19%|████████████████████████▋                                                                                                        | 956/5000 [3Training (loss: 8.6658):  19%|████████████████████████▋                                                                                                        | 957/5000 [3Training (loss: 8.6658):  19%|████████████████████████▋                                                                                                        | 958/5000 [3Training (loss: 8.6658):  19%|████████████████████████▋                                                                                                        | 959/5000 [3Training (loss: 8.6658):  19%|████████████████████████▊                                                                                                        | 960/5000 [3Training (loss: 8.6658):  19%|████████████████████████▊                                                                                                        | 961/5000 [3Training (loss: 8.6658):  19%|████████████████████████▊                                                                                                        | 962/5000 [3Training (loss: 8.6658):  19%|████████████████████████▊                                                                                                        | 963/5000 [3Training (loss: 8.6658):  19%|████████████████████████▊                                                                                                        | 964/5000 [3Training (loss: 8.6658):  19%|████████████████████████▉                                                                                                        | 965/5000 [3Training (loss: 8.6658):  19%|████████████████████████▉                                                                                                        | 966/5000 [3Training (loss: 8.6658):  19%|████████████████████████▉                                                                                                        | 967/5000 [3Training (loss: 8.6658):  19%|████████████████████████▉                                                                                                        | 968/5000 [3Training (loss: 8.6658):  19%|█████████████████████████                                                                                                        | 969/5000 [3Training (loss: 8.6658):  19%|█████████████████████████                                                                                                        | 970/5000 [3Training (loss: 8.6658):  19%|█████████████████████████                                                                                                        | 971/5000 [3Training (loss: 8.6658):  19%|█████████████████████████                                                                                                        | 972/5000 [3Training (loss: 8.6658):  19%|█████████████████████████                                                                                                        | 973/5000 [3Training (loss: 8.6658):  19%|█████████████████████████▏                                                                                                       | 974/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▏                                                                                                       | 975/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▏                                                                                                       | 976/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▏                                                                                                       | 977/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▏                                                                                                       | 978/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▎                                                                                                       | 979/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▎                                                                                                       | 980/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▎                                                                                                       | 981/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▎                                                                                                       | 982/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▎                                                                                                       | 983/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▍                                                                                                       | 984/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▍                                                                                                       | 985/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▍                                                                                                       | 986/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▍                                                                                                       | 987/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▍                                                                                                       | 988/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                       | 989/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                       | 990/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                       | 991/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                       | 992/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                       | 993/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▋                                                                                                       | 994/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▋                                                                                                       | 995/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▋                                                                                                       | 996/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▋                                                                                                       | 997/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▋                                                                                                       | 998/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▊                                                                                                       | 999/5000 [3Training (loss: 8.6658):  20%|█████████████████████████▌                                                                                                      | 1000/5000 [3Training (loss: 7.7838):  20%|█████████████████████████▌                                                                                                      | 1000/5000 [39:01<2:33:22,  2.30s/it]2025-01-25 11:34:39,617 - INFO - 
Sample generation at step 1000:
2025-01-25 11:34:39,617 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 11:34:39,618 - INFO - Generated: Once upon a time, in a distant galaxyccmarbbbbbbbbbbbbbbelfelf A A A A A A A A A A A A A A A A A A A A A A A A A A A A A A A!!!!!KELurdILILILILILILILCHILILRURUILILILILILILILILILILILILILelfelfelfelfelfelfelfelfelfelfelfelfelfelfelfelf

2025-01-25 11:34:41,627 - INFO - Checkpoint saved at step 1000
Training (loss: 7.7838):  20%|█████████████████████████▋                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▋                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▋                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▋                                                                                       Training (loss: 7.7838):  20%|█████████████████████████▋                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▊                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▊                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▊                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▊                                                                       Training (loss: 7.7838):  20%|█████████████████████████▊                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▉                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▉                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▉                                                                                                    Training (loss: 7.7838):  20%|█████████████████████████▉                                                                                                            Training (loss: 7.7838):  20%|█████████████████████████▉                                                                                                            Training (loss: 7.7838):  20%|██████████████████████████                                                                                                            Training (loss: 7.7838):  20%|██████████████████████████                                                                                                            Training (loss: 7.7838):  20%|██████████████████████████                                                                                    Training (loss: 7.7838):  20%|██████████████████████████                                                                                                            Training (loss: 7.7838):  20%|██████████████████████████                                                                                                            Training (loss: 7.7838):  20%|██████████████████████████▏                                                                                                           Training (loss: 7.7838):  20%|██████████████████████████▏                                                                                                           Training (loss: 7.7838):  20%|██████████████████████████▏                                                                   Training (loss: 7.7838):  20%|██████████████████████████▏                                                                                                           Training (loss: 7.7838):  20%|██████████████████████████▏                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▎                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▎                                                                                                Training (loss: 7.7838):  21%|██████████████████████████▎                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▎                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▎                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▍                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▍                                                                                Training (loss: 7.7838):  21%|██████████████████████████▍                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▍                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▍                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▌                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▌                                                                Training (loss: 7.7838):  21%|██████████████████████████▌                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▌                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▌                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▋                                                                                             Training (loss: 7.7838):  21%|██████████████████████████▋                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▋                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▋                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▊                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▊                                                                             Training (loss: 7.7838):  21%|██████████████████████████▊                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▊                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▊                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▉                                                                                                          Training (loss: 7.7838):  21%|██████████████████████████▉                                                             Training (loss: 7.7838):  21%|██████████████████████████▉                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▉                                                                                                           Training (loss: 7.7838):  21%|██████████████████████████▉                                                                                                           Training (loss: 7.7838):  21%|███████████████████████████                                                                                          Training (loss: 7.7838):  21%|███████████████████████████                                                                                                           Training (loss: 7.7838):  21%|███████████████████████████                                                                                                           Training (loss: 7.7838):  21%|███████████████████████████                                                                                                           Training (loss: 7.7838):  21%|███████████████████████████                                                                                                           Training (loss: 7.7838):  21%|███████████████████████████▏                                                                         Training (loss: 7.7838):  21%|███████████████████████████▏                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▏                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▏                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▏                                                                                                      Training (loss: 7.7838):  21%|███████████████████████████▎                                                         Training (loss: 7.7838):  21%|███████████████████████████▎                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▎                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▎                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▎                                                                                      Training (loss: 7.7838):  21%|███████████████████████████▍                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▍                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▍                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▍                                                                                                          Training (loss: 7.7838):  21%|███████████████████████████▍                                                                      Training (loss: 7.7838):  22%|███████████████████████████▌                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▌                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▌                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▌                                                                                                   Training (loss: 7.7838):  22%|███████████████████████████▌                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▋                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▋                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▋                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▋                                                                                   Training (loss: 7.7838):  22%|███████████████████████████▊                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▊                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▊                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▊                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▊                                                                   Training (loss: 7.7838):  22%|███████████████████████████▉                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▉                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▉                                                                                                          Training (loss: 7.7838):  22%|███████████████████████████▉                                                                                                Training (loss: 7.7838):  22%|███████████████████████████▉                                                                                                          Training (loss: 7.7838):  22%|████████████████████████████                                                                                                          Training (loss: 7.7838):  22%|████████████████████████████                                                                                                          Training (loss: 7.7838):  22%|████████████████████████████                                                                                                          Training (loss: 7.7838):  22%|████████████████████████████                                                                                Training (loss: 7.7838):  22%|████████████████████████████                                                                                                          Training (loss: 7.7838):  22%|████████████████████████████▏                                                                                                         Training (loss: 7.7838):  22%|████████████████████████████▏                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▏                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▏                                                               Training (loss: 7.8702):  22%|████████████████████████████▏                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▏                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▎                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▎                                                                                            Training (loss: 7.8702):  22%|████████████████████████████▎                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▎                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▎                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▍                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▍                                                                            Training (loss: 7.8702):  22%|████████████████████████████▍                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▍                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▍                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▌                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▌                                                            Training (loss: 7.8702):  22%|████████████████████████████▌                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▌                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▌                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▋                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▋                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▋                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▋                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▋                                                                                                         Training (loss: 7.8702):  22%|████████████████████████████▊                                                                         Training (loss: 7.8702):  22%|████████████████████████████▊                                                                                                         Training (loss: 7.8702):  23%|████████████████████████████▊                                                                                                         Training (loss: 7.8702):  23%|████████████████████████████▊                                                                                                         Training (loss: 7.8702):  23%|████████████████████████████▉                                                                                                      Training (loss: 7.8702):  23%|████████████████████████████▉                                                         Training (loss: 7.8702):  23%|████████████████████████████▉                                                                                                         Training (loss: 7.8702):  23%|████████████████████████████▉                                                                                                         Training (loss: 7.8702):  23%|████████████████████████████▉                                                                                                         Training (loss: 7.8702):  23%|█████████████████████████████                                                                                      Training (loss: 7.8702):  23%|█████████████████████████████                                                                                                         Training (loss: 7.8702):  23%|█████████████████████████████                                                                                                         Training (loss: 7.8702):  23%|█████████████████████████████                                                                                                         Training (loss: 7.8702):  23%|█████████████████████████████                                                                                                         Training (loss: 7.8702):  23%|█████████████████████████████▏                                                                     Training (loss: 7.8702):  23%|█████████████████████████████▏                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▏                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▏                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▏                                                                                                  Training (loss: 7.8702):  23%|█████████████████████████████▎                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▎                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▎                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▎                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▎                                                                                  Training (loss: 7.8702):  23%|█████████████████████████████▍                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▍                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▍                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▍                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▍                                                                  Training (loss: 7.8702):  23%|█████████████████████████████▌                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▌                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▌                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▌                                                                                               Training (loss: 7.8702):  23%|█████████████████████████████▌                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▋                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▋                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▋                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▋                                                                               Training (loss: 7.8702):  23%|█████████████████████████████▋                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▊                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▊                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▊                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▊                                                               Training (loss: 7.8702):  23%|█████████████████████████████▉                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▉                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▉                                                                                                        Training (loss: 7.8702):  23%|█████████████████████████████▉                                                                                            Training (loss: 7.8702):  23%|█████████████████████████████▉                                                                                                        Training (loss: 7.8702):  23%|██████████████████████████████                                                                                                        Training (loss: 7.8702):  23%|██████████████████████████████                                                                                                        Training (loss: 7.8702):  23%|██████████████████████████████                                                                                                        Training (loss: 7.8702):  24%|██████████████████████████████                                                                            Training (loss: 7.8702):  24%|██████████████████████████████                                                                                                        Training (loss: 7.8702):  24%|██████████████████████████████▏                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▏                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▏                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▏                                                           Training (loss: 7.8702):  24%|██████████████████████████████▏                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▎                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▎                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▎                                                                                        Training (loss: 7.8702):  24%|██████████████████████████████▎                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▎                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▍                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▍                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▍                                                                        Training (loss: 7.8702):  24%|██████████████████████████████▍                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▍                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▌                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▌                                                                                                     Training (loss: 7.8702):  24%|██████████████████████████████▌                                                        Training (loss: 7.8702):  24%|██████████████████████████████▌                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▌                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▋                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▋                                                                                     Training (loss: 7.8702):  24%|██████████████████████████████▋                                                                                                       Training (loss: 7.8702):  24%|██████████████████████████████▋                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▋                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▋                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▊                                                                     Training (loss: 7.6461):  24%|██████████████████████████████▊                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▊                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▊                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▊                                                                                                  Training (loss: 7.6461):  24%|██████████████████████████████▉                                                     Training (loss: 7.6461):  24%|██████████████████████████████▉                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▉                                                                                                       Training (loss: 7.6461):  24%|██████████████████████████████▉                                                                                                       Training (loss: 7.6461):  24%|███████████████████████████████                                                                                  Training (loss: 7.6461):  24%|███████████████████████████████                                                                                                       Training (loss: 7.6461):  24%|███████████████████████████████                                                                                                       Training (loss: 7.6461):  24%|███████████████████████████████                                                                                                       Training (loss: 7.6461):  24%|███████████████████████████████                                                                                                       Training (loss: 7.6461):  24%|███████████████████████████████▏                                                                 Training (loss: 7.6461):  24%|███████████████████████████████▏                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▏                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▏                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▏                                                                                              Training (loss: 7.6461):  24%|███████████████████████████████▎                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▎                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▎                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▎                                                                                                      Training (loss: 7.6461):  24%|███████████████████████████████▎                                                                              Training (loss: 7.6461):  25%|███████████████████████████████▍                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▍                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▍                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▍                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▍                                                              Training (loss: 7.6461):  25%|███████████████████████████████▌                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▌                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▌                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▌                                                                                           Training (loss: 7.6461):  25%|███████████████████████████████▌                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▋                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▋                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▋                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▋                                                                           Training (loss: 7.6461):  25%|███████████████████████████████▋                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▊                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▊                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▊                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▊                                                           Training (loss: 7.6461):  25%|███████████████████████████████▊                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▉                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▉                                                                                                      Training (loss: 7.6461):  25%|███████████████████████████████▉                                                                                        Training (loss: 7.6461):  25%|███████████████████████████████▉                                                                                                      Training (loss: 7.6461):  25%|████████████████████████████████                                                                                                      Training (loss: 7.6461):  25%|████████████████████████████████                                                                                                      Training (loss: 7.6461):  25%|████████████████████████████████                                                                                                      Training (loss: 7.6461):  25%|████████████████████████████████                                                                        Training (loss: 7.6461):  25%|████████████████████████████████                                                                                                      Training (loss: 7.6461):  25%|████████████████████████████████▏                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▏                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▏                                                                                                    Training (loss: 7.6461):  25%|████████████████████████████████▏                                                       Training (loss: 7.6461):  25%|████████████████████████████████▏                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▎                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▎                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▎                                                                                    Training (loss: 7.6461):  25%|████████████████████████████████▎                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▎                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▍                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▍                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▍                                                                    Training (loss: 7.6461):  25%|████████████████████████████████▍                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▍                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▌                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▌                                                                                                 Training (loss: 7.6461):  25%|████████████████████████████████▌                                                    Training (loss: 7.6461):  25%|████████████████████████████████▌                                                                                                     Training (loss: 7.6461):  25%|████████████████████████████████▌                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▋                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▋                                                                                 Training (loss: 7.6461):  26%|████████████████████████████████▋                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▋                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▋                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▊                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▊                                                                 Training (loss: 7.6461):  26%|████████████████████████████████▊                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▊                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▊                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▉                                                                                              Training (loss: 7.6461):  26%|████████████████████████████████▉                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▉                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▉                                                                                                     Training (loss: 7.6461):  26%|████████████████████████████████▉                                                                                                     Training (loss: 7.6461):  26%|█████████████████████████████████                                                                              Training (loss: 7.6461):  26%|█████████████████████████████████                                                                                                     Training (loss: 7.6461):  26%|█████████████████████████████████                                                                                                     Training (loss: 7.6461):  26%|█████████████████████████████████                                                                                                     Training (loss: 7.6461):  26%|█████████████████████████████████▏                                                                                                    Training (loss: 7.6461):  26%|█████████████████████████████████▏                                                             Training (loss: 7.6461):  26%|█████████████████████████████████▏                                                                                                    Training (loss: 7.6461):  26%|█████████████████████████████████▏                                                                                                    Training (loss: 7.6461):  26%|█████████████████████████████████▏                                                                                                    Training (loss: 7.6461):  26%|█████████████████████████████████▎                                                                                          Training (loss: 7.6461):  26%|█████████████████████████████████▎                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▎                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▎                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▎                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▎                                                                          Training (loss: 7.5068):  26%|█████████████████████████████████▍                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▍                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▍                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▍                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▍                                                          Training (loss: 7.5068):  26%|█████████████████████████████████▌                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▌                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▌                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▌                                                                                       Training (loss: 7.5068):  26%|█████████████████████████████████▌                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▋                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▋                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▋                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▋                                                                       Training (loss: 7.5068):  26%|█████████████████████████████████▋                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▊                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▊                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▊                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▊                                                       Training (loss: 7.5068):  26%|█████████████████████████████████▊                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▉                                                                                                    Training (loss: 7.5068):  26%|█████████████████████████████████▉                                                                                                    Training (loss: 7.5068):  27%|█████████████████████████████████▉                                                                                    Training (loss: 7.5068):  27%|█████████████████████████████████▉                                                                                                    Training (loss: 7.5068):  27%|█████████████████████████████████▉                                                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████                                                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████                                                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████                                                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████                                                                                                    Training (loss: 7.5068):  27%|██████████████████████████████████▏                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▏                                                                                                Training (loss: 7.5068):  27%|██████████████████████████████████▏                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▏                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▎                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▎                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▎                                                                                Training (loss: 7.5068):  27%|██████████████████████████████████▎                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▎                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▍                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▍                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▍                                                                Training (loss: 7.5068):  27%|██████████████████████████████████▍                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▍                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▌                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▌                                                                                             Training (loss: 7.5068):  27%|██████████████████████████████████▌                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▌                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▌                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▋                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▋                                                                             Training (loss: 7.5068):  27%|██████████████████████████████████▋                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▋                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▋                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▊                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▊                                                             Training (loss: 7.5068):  27%|██████████████████████████████████▊                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▊                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▊                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▉                                                                                          Training (loss: 7.5068):  27%|██████████████████████████████████▉                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▉                                                                                                   Training (loss: 7.5068):  27%|██████████████████████████████████▉                                                                                             | 1366Training (loss: 7.5068):  27%|██████████████████████████████████▉                                                                                             | 1367Training (loss: 7.5068):  27%|███████████████████████████████████                                                                                             | 1368Training (loss: 7.5068):  27%|███████████████████████████████████                                                                                             | 1369Training (loss: 7.5068):  27%|███████████████████████████████████                                                                                             | 1370Training (loss: 7.5068):  27%|███████████████████████████████████                                                                                             | 1371Training (loss: 7.5068):  27%|███████████████████████████████████                                                                                             | 1372Training (loss: 7.5068):  27%|███████████████████████████████████▏                                                                                            | 1373Training (loss: 7.5068):  27%|███████████████████████████████████▏                                                                                            | 1374Training (loss: 7.5068):  28%|███████████████████████████████████▏                                                                                            | 1375Training (loss: 7.5068):  28%|███████████████████████████████████▏                                                                                            | 1376Training (loss: 7.5068):  28%|███████████████████████████████████▎                                                                                            | 1377Training (loss: 7.5068):  28%|███████████████████████████████████▎                                                                                            | 1378Training (loss: 7.5068):  28%|███████████████████████████████████▎                                                                                            | 1379Training (loss: 7.5068):  28%|███████████████████████████████████▎                                                                                            | 1380Training (loss: 7.5068):  28%|███████████████████████████████████▎                                                                                            | 1381Training (loss: 7.5068):  28%|███████████████████████████████████▍                                                                                            | 1382Training (loss: 7.5068):  28%|███████████████████████████████████▍                                                                                            | 1383Training (loss: 7.5068):  28%|███████████████████████████████████▍                                                                                            | 1384Training (loss: 7.5068):  28%|███████████████████████████████████▍                                                                                            | 1385Training (loss: 7.5068):  28%|███████████████████████████████████▍                                                                                            | 1386Training (loss: 7.5068):  28%|███████████████████████████████████▌                                                                                            | 1387Training (loss: 7.5068):  28%|███████████████████████████████████▌                                                                                            | 1388Training (loss: 7.5068):  28%|███████████████████████████████████▌                                                                                            | 1389Training (loss: 7.5068):  28%|███████████████████████████████████▌                                                                                            | 1390Training (loss: 7.5068):  28%|███████████████████████████████████▌                                                                                            | 1391Training (loss: 7.5068):  28%|███████████████████████████████████▋                                                                                            | 1392Training (loss: 7.5068):  28%|███████████████████████████████████▋                                                                                            | 1393Training (loss: 7.5068):  28%|███████████████████████████████████▋                                                                                            | 1394Training (loss: 7.5068):  28%|███████████████████████████████████▋                                                                                            | 1395Training (loss: 7.5068):  28%|███████████████████████████████████▋                                                                                            | 1396Training (loss: 7.5068):  28%|███████████████████████████████████▊                                                                                            | 1397Training (loss: 7.5068):  28%|███████████████████████████████████▊                                                                                            | 1398Training (loss: 7.5068):  28%|███████████████████████████████████▊                                                                                            | 1399Training (loss: 7.5068):  28%|███████████████████████████████████▊                                                                                            | 1400Training (loss: 7.6054):  28%|███████████████████████████████████▊                                                                                            | 1400Training (loss: 7.6054):  28%|███████████████████████████████████▊                                                                                            | 1401Training (loss: 7.6054):  28%|███████████████████████████████████▉                                                                                            | 1402Training (loss: 7.6054):  28%|███████████████████████████████████▉                                                                                            | 1403Training (loss: 7.6054):  28%|███████████████████████████████████▉                                                                                            | 1404Training (loss: 7.6054):  28%|███████████████████████████████████▉                                                                                            | 1405Training (loss: 7.6054):  28%|███████████████████████████████████▉                                                                                            | 1406Training (loss: 7.6054):  28%|████████████████████████████████████                                                                                            | 1407Training (loss: 7.6054):  28%|████████████████████████████████████                                                                                            | 1408Training (loss: 7.6054):  28%|████████████████████████████████████                                                                                            | 1409Training (loss: 7.6054):  28%|████████████████████████████████████                                                                                            | 1410Training (loss: 7.6054):  28%|████████████████████████████████████                                                                                            | 1411Training (loss: 7.6054):  28%|████████████████████████████████████▏                                                                                           | 1412Training (loss: 7.6054):  28%|████████████████████████████████████▏                                                                                           | 1413Training (loss: 7.6054):  28%|████████████████████████████████████▏                                                                                           | 1414Training (loss: 7.6054):  28%|████████████████████████████████████▏                                                                                           | 1415Training (loss: 7.6054):  28%|████████████████████████████████████▏                                                                                           | 1416Training (loss: 7.6054):  28%|████████████████████████████████████▎                                                                                           | 1417Training (loss: 7.6054):  28%|████████████████████████████████████▎                                                                                           | 1418Training (loss: 7.6054):  28%|████████████████████████████████████▎                                                                                           | 1419Training (loss: 7.6054):  28%|████████████████████████████████████▎                                                                                           | 1420Training (loss: 7.6054):  28%|████████████████████████████████████▍                                                                                           | 1421Training (loss: 7.6054):  28%|████████████████████████████████████▍                                                                                           | 1422Training (loss: 7.6054):  28%|████████████████████████████████████▍                                                                                           | 1423Training (loss: 7.6054):  28%|████████████████████████████████████▍                                                                                           | 1424Training (loss: 7.6054):  28%|████████████████████████████████████▍                                                                                           | 1425Training (loss: 7.6054):  29%|████████████████████████████████████▌                                                                                           | 1426Training (loss: 7.6054):  29%|████████████████████████████████████▌                                                                                           | 1427Training (loss: 7.6054):  29%|████████████████████████████████████▌                                                                                           | 1428Training (loss: 7.6054):  29%|████████████████████████████████████▌                                                                                           | 1429Training (loss: 7.6054):  29%|████████████████████████████████████▌                                                                                           | 1430Training (loss: 7.6054):  29%|████████████████████████████████████▋                                                                                           | 1431Training (loss: 7.6054):  29%|████████████████████████████████████▋                                                                                           | 1432Training (loss: 7.6054):  29%|████████████████████████████████████▋                                                                                           | 1433Training (loss: 7.6054):  29%|████████████████████████████████████▋                                                                                           | 1434Training (loss: 7.6054):  29%|████████████████████████████████████▋                                                                                           | 1435Training (loss: 7.6054):  29%|████████████████████████████████████▊                                                                                           | 1436Training (loss: 7.6054):  29%|████████████████████████████████████▊                                                                                           | 1437Training (loss: 7.6054):  29%|████████████████████████████████████▊                                                                                           | 1438Training (loss: 7.6054):  29%|████████████████████████████████████▊                                                                                           | 1439Training (loss: 7.6054):  29%|████████████████████████████████████▊                                                                                           | 1440Training (loss: 7.6054):  29%|████████████████████████████████████▉                                                                                           | 1441Training (loss: 7.6054):  29%|████████████████████████████████████▉                                                                                           | 1442Training (loss: 7.6054):  29%|████████████████████████████████████▉                                                                                           | 1443Training (loss: 7.6054):  29%|████████████████████████████████████▉                                                                                           | 1444Training (loss: 7.6054):  29%|████████████████████████████████████▉                                                                                           | 1445Training (loss: 7.6054):  29%|█████████████████████████████████████                                                                                           | 1446Training (loss: 7.6054):  29%|█████████████████████████████████████                                                                                           | 1447Training (loss: 7.6054):  29%|█████████████████████████████████████                                                                                           | 1448Training (loss: 7.6054):  29%|█████████████████████████████████████                                                                                           | 1449Training (loss: 7.6054):  29%|█████████████████████████████████████                                                                                           | 1450Training (loss: 7.6054):  29%|█████████████████████████████████████▏                                                                                          | 1451Training (loss: 7.6054):  29%|█████████████████████████████████████▏                                                                                          | 1452Training (loss: 7.6054):  29%|█████████████████████████████████████▏                                                                                          | 1453Training (loss: 7.6054):  29%|█████████████████████████████████████▏                                                                                          | 1454Training (loss: 7.6054):  29%|█████████████████████████████████████▏                                                                                          | 1455Training (loss: 7.6054):  29%|█████████████████████████████████████▎                                                                                          | 1456Training (loss: 7.6054):  29%|█████████████████████████████████████▎                                                                                          | 1457Training (loss: 7.6054):  29%|█████████████████████████████████████▎                                                                                          | 1458Training (loss: 7.6054):  29%|█████████████████████████████████████▎                                                                                          | 1459Training (loss: 7.6054):  29%|█████████████████████████████████████▍                                                                                          | 1460Training (loss: 7.6054):  29%|█████████████████████████████████████▍                                                                                          | 1461Training (loss: 7.6054):  29%|█████████████████████████████████████▍                                                                                          | 1462Training (loss: 7.6054):  29%|█████████████████████████████████████▍                                                                                          | 1463Training (loss: 7.6054):  29%|█████████████████████████████████████▍                                                                                          | 1464Training (loss: 7.6054):  29%|█████████████████████████████████████▌                                                                                          | 1465Training (loss: 7.6054):  29%|█████████████████████████████████████▌                                                                                          | 1466Training (loss: 7.6054):  29%|█████████████████████████████████████▌                                                                                          | 1467Training (loss: 7.6054):  29%|█████████████████████████████████████▌                                                                                          | 1468Training (loss: 7.6054):  29%|█████████████████████████████████████▌                                                                                          | 1469Training (loss: 7.6054):  29%|█████████████████████████████████████▋                                                                                          | 1470Training (loss: 7.6054):  29%|█████████████████████████████████████▋                                                                                          | 1471Training (loss: 7.6054):  29%|█████████████████████████████████████▋                                                                                          | 1472Training (loss: 7.6054):  29%|█████████████████████████████████████▋                                                                                          | 1473Training (loss: 7.6054):  29%|█████████████████████████████████████▋                                                                                          | 1474Training (loss: 7.6054):  30%|█████████████████████████████████████▊                                                                                          | 1475Training (loss: 7.6054):  30%|█████████████████████████████████████▊                                                                                          | 1476Training (loss: 7.6054):  30%|█████████████████████████████████████▊                                                                                          | 1477Training (loss: 7.6054):  30%|█████████████████████████████████████▊                                                                                          | 1478Training (loss: 7.6054):  30%|█████████████████████████████████████▊                                                                                          | 1479Training (loss: 7.6054):  30%|█████████████████████████████████████▉                                                                                          | 1480Training (loss: 7.6054):  30%|█████████████████████████████████████▉                                                                                          | 1481Training (loss: 7.6054):  30%|█████████████████████████████████████▉                                                                                          | 1482Training (loss: 7.6054):  30%|█████████████████████████████████████▉                                                                                          | 1483Training (loss: 7.6054):  30%|█████████████████████████████████████▉                                                                                          | 1484Training (loss: 7.6054):  30%|██████████████████████████████████████                                                                                          | 1485Training (loss: 7.6054):  30%|██████████████████████████████████████                                                                                          | 1486Training (loss: 7.6054):  30%|██████████████████████████████████████                                                                                          | 1487Training (loss: 7.6054):  30%|██████████████████████████████████████                                                                                          | 1488Training (loss: 7.6054):  30%|██████████████████████████████████████                                                                                          | 1489Training (loss: 7.6054):  30%|██████████████████████████████████████▏                                                                                         | 1490Training (loss: 7.6054):  30%|██████████████████████████████████████▏                                                                                         | 1491Training (loss: 7.6054):  30%|██████████████████████████████████████▏                                                                                         | 1492Training (loss: 7.6054):  30%|██████████████████████████████████████▏                                                                                         | 1493Training (loss: 7.6054):  30%|██████████████████████████████████████▏                                                                                         | 1494Training (loss: 7.6054):  30%|██████████████████████████████████████▎                                                                                         | 1495Training (loss: 7.6054):  30%|██████████████████████████████████████▎                                                                                         | 1496Training (loss: 7.6054):  30%|██████████████████████████████████████▎                                                                                         | 1497Training (loss: 7.6054):  30%|██████████████████████████████████████▎                                                                                         | 1498Training (loss: 7.6054):  30%|██████████████████████████████████████▎                                                                                         | 1499Training (loss: 7.6054):  30%|██████████████████████████████████████▍                                                                                         | 1500Training (loss: 8.0314):  30%|██████████████████████████████████████▍                                                                                         | 1500/5000 [58:16<2:14:24,  2.30s/it]2025-01-25 11:53:53,859 - INFO - 
Sample generation at step 1500:
2025-01-25 11:53:53,859 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 11:53:53,859 - INFO - Generated: Once upon a time, in a distant galaxyARARARARARARARARARARARARARARARARARARARARARARARARARARARARARARARARURARARARARARHHHHHHHHHHHHHHHHHHHHHHHHHHHHURARARARARHHHHHHHHHHHHHHHHHHHHHHHMPMPHHMP poor

2025-01-25 11:53:55,816 - INFO - Checkpoint saved at step 1500
Training (loss: 8.0314):  30%|██████████████████████████████████████▍                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▍                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▍                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▌                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▌                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▌                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▌                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▌                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▋                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▋                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▋                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▋                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▋                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  30%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  30%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  30%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|██████████████████████████████████████▊                                                                                  Training (loss: 8.0314):  31%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  31%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  31%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  31%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  31%|██████████████████████████████████████▉                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████                                                                                  Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▏                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▎                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▍                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▌                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▌                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▌                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▌                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▌                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▋                                                                                 Training (loss: 8.0314):  31%|███████████████████████████████████████▋                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▋                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▋                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▋                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▊                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▊                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▊                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▊                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▊                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▉                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▉                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▉                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▉                                                                                 Training (loss: 8.0314):  32%|███████████████████████████████████████▉                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████                                                                                 Training (loss: 8.0314):  32%|████████████████████████████████████████▏                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▏                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▏                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▏                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▏                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▎                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▎                                                                                Training (loss: 8.0314):  32%|████████████████████████████████████████▎                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▎                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▎                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▎                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▍                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▍                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▍                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▍                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▍                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▌                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▌                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▌                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▌                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▌                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▋                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▋                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▋                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▋                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▋                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▊                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▊                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▊                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▊                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▊                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▉                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▉                                                                                Training (loss: 7.8674):  32%|████████████████████████████████████████▉                                                                                Training (loss: 7.8674):  33%|████████████████████████████████████████▉                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████                                                                                Training (loss: 7.8674):  33%|█████████████████████████████████████████▏                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▏                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▏                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▏                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▏                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▎                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▎                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▎                                                                               Training (loss: 7.8674):  33%|█████████████████████████████████████████▎                                                                                    | 1641/5000 [1:03:48<2:05:Training (loss: 7.8674):  33%|█████████████████████████████████████████▍                                                                                    | 1642/5000 [1:03:50<2:06:Training (loss: 7.8674):  33%|█████████████████████████████████████████▍                                                                                    | 1643/5000 [1:03:52<2:07:Training (loss: 7.8674):  33%|█████████████████████████████████████████▍                                                                                    | 1644/5000 [1:03:55<2:06:Training (loss: 5.9501):  40%|██████████████████████████████████████████████████▍                                                                           | 2000/5000 [1:17:36<1:53:50,  2.28s/it]2025-01-25 12:13:08,303 - INFO - 
Sample generation at step 2000:
2025-01-25 12:13:08,303 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 12:13:08,303 - INFO - Generated: Once upon a time, in a distant galaxy<|endoftext|>

2025-01-25 12:13:10,272 - INFO - Checkpoint saved at step 2000
Training (loss: 5.8637):  50%|███████████████████████████████████████████████████████████████                                                               | 2500/5000 [1:36:41<1:35:25,  2.29s/it]2025-01-25 12:32:14,315 - INFO - 
Sample generation at step 2500:
2025-01-25 12:32:14,315 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 12:32:14,315 - INFO - Generated: Once upon a time, in a distant galaxy fought fought fought fought fought fought fought fought fought fought fought<|endoftext|>

2025-01-25 12:32:16,304 - INFO - Checkpoint saved at step 2500
Training (loss: 6.0858):  60%|███████████████████████████████████████████████████████████████████████████▌                                                  | 3000/5000 [1:56:08<1:17:43,  2.33s/it]2025-01-25 12:51:46,125 - INFO - 
Sample generation at step 3000:
2025-01-25 12:51:46,126 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 12:51:46,126 - INFO - Generated: Once upon a time, in a distant galaxyan lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady lady ladyanYYYYYYYYYYYYYYYYYYYYYYYYIZICKICKICKYYIZICKICK

2025-01-25 12:51:48,148 - INFO - Checkpoint saved at step 3000
Training (loss: 5.9042):  70%|█████████████████████████████████████████████████████████████████████████████████████████▌                                      | 3500/5000 [2:15:40<58:12,  2.33s/it]2025-01-25 13:11:17,884 - INFO - 
Sample generation at step 3500:
2025-01-25 13:11:17,884 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 13:11:17,884 - INFO - Generated: Once upon a time, in a distant galaxyp cityailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailailail

2025-01-25 13:11:19,857 - INFO - Checkpoint saved at step 3500
Training (loss: 5.6901):  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 4000/5000 [2:35:10<38:40,  2.32s/it]2025-01-25 13:30:42,781 - INFO - 
Sample generation at step 4000:
2025-01-25 13:30:42,781 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 13:30:42,781 - INFO - Generated: Once upon a time, in a distant galaxyom<|endoftext|>

2025-01-25 13:30:44,675 - INFO - Checkpoint saved at step 4000
Training (loss: 5.6585):  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 4500/5000 [2:54:36<19:25,  2.33s/it]2025-01-25 13:50:08,301 - INFO - 
Sample generation at step 4500:
2025-01-25 13:50:08,302 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 13:50:08,302 - INFO - Generated: Once upon a time, in a distant galaxyD<|endoftext|>

2025-01-25 13:50:10,226 - INFO - Checkpoint saved at step 4500
Training (loss: 5.0391): 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5000/5000 [3:14:01<00:00,  2.32s/it]2025-01-25 14:09:35,828 - INFO - 
Sample generation at step 5000:
2025-01-25 14:09:35,828 - INFO - Prompt: Once upon a time, in a distant galaxy
2025-01-25 14:09:35,829 - INFO - Generated: Once upon a time, in a distant galaxy ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready ready readyAA<|endoftext|>

2025-01-25 14:09:37,772 - INFO - Checkpoint saved at step 5000
Training (loss: 5.0391): 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5000/5000 [3:14:05<00:00,  2.33s/it]
2025-01-25 14:09:39,364 - INFO - Checkpoint saved at step 5000
```

Stopping training. and started one more training for 50 steps
```

(venv) narendra.kalekar@MAC-KJF4T0J3JR SmolLM2-135-reverse-engineer-model-and-train % python3 train.py
2025-01-25 14:14:46,798 - INFO - Using device: mps
2025-01-25 14:14:48,777 - INFO - 
Model Architecture:
2025-01-25 14:14:48,777 - INFO - ==================================================
2025-01-25 14:14:48,777 - INFO - LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(49152, 576)
    (layers): ModuleList(
      (0-29): 30 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=576, out_features=576, bias=False)
          (k_proj): Linear(in_features=576, out_features=192, bias=False)
          (v_proj): Linear(in_features=576, out_features=192, bias=False)
          (o_proj): Linear(in_features=576, out_features=576, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=576, out_features=1536, bias=False)
          (up_proj): Linear(in_features=576, out_features=1536, bias=False)
          (down_proj): Linear(in_features=1536, out_features=576, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=576, out_features=49152, bias=False)
)
2025-01-25 14:14:48,778 - INFO - ==================================================
2025-01-25 14:14:48,779 - INFO - 
Total trainable parameters: 134,515,008 (134.52M)
2025-01-25 14:14:48,779 - INFO - ==================================================

2025-01-25 14:14:49,107 - INFO - Set pad_token to eos_token
2025-01-25 14:14:49,109 - INFO - Loaded 7222 text segments from input.txt
2025-01-25 14:14:49,109 - INFO - Found checkpoint at 5000 steps. Loading and training for 50 more steps.
/Users/narendra.kalekar/Documents/personal/ERA/SmolLM2-135-reverse-engineer-model-and-train/train.py:101: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path)
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5050/5050 [01:54<00:00,  2.29s/it]
2025-01-25 14:16:46,267 - INFO - Checkpoint saved at step 5050
2025-01-25 14:16:46,267 - INFO - Training completed!
```